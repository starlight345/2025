<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,a=e=>{let t=e.split(" "),a=t.slice(0,-1).join(" ");return[t.at(-1),a]},n=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(a),o=n[0][0],i=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"April 28, 2025"),r="Intricacies of Feature Geometry in Large Language Models",l="Studying the geometry of a language model's embedding space is an important and challenging task because of the various ways concepts can be represented, extracted, and used. Specifically, we want a framework that unifies both measurement (of how well a latent explains a feature/concept) and causal intervention (how well it can be used to control/steer the model). We discuss several challenges with using some recent approaches to study the geometry of categorical and hierarchical concepts in large language models (LLMs) and both theoretically and empirically justify our main takeaway, which is that their orthogonality and polytopes results are trivially true in high-dimensional spaces, and can be observed even in settings where they should not occur.";{let e=n.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@inproceedings{${(o+"2025"+r.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${r}},\n  abstract = {${l}},\n  booktitle = {ICLR Blogposts 2025},\n  year = {2025},\n  date = {${i}},\n  note = {${window.location.href}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}{let e=n.map(e=>e[0]),t=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${r}", ICLR Blogposts, 2025.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Intricacies of Feature Geometry in Large Language Models | ICLR Blogposts 2025</title> <meta name="author" content="ICLR Blog"> <meta name="description" content="Studying the geometry of a language model's embedding space is an important and challenging task because of the various ways concepts can be represented, extracted, and used. Specifically, we want a framework that unifies both measurement (of how well a latent explains a feature/concept) and causal intervention (how well it can be used to control/steer the model). We discuss several challenges with using some recent approaches to study the geometry of categorical and hierarchical concepts in large language models (LLMs) and both theoretically and empirically justify our main takeaway, which is that their orthogonality and polytopes results are trivially true in high-dimensional spaces, and can be observed even in settings where they should not occur."> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/2025/assets/img/iclr_favicon.ico"> <link rel="stylesheet" href="/2025/assets/css/main.css"> <link rel="canonical" href="https://starlight345.github.io/2025/blog/feature-geometry/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/2025/assets/js/theme.js"></script> <script src="/2025/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/2025/assets/js/distillpub/template.v2.js"></script> <script src="/2025/assets/js/distillpub/transforms.v2.js"></script> <script src="/2025/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> <d-front-matter> <script async type="text/json">{
      "title": "Intricacies of Feature Geometry in Large Language Models",
      "description": "Studying the geometry of a language model's embedding space is an important and challenging task because of the various ways concepts can be represented, extracted, and used. Specifically, we want a framework that unifies both measurement (of how well a latent explains a feature/concept) and causal intervention (how well it can be used to control/steer the model). We discuss several challenges with using some recent approaches to study the geometry of categorical and hierarchical concepts in large language models (LLMs) and both theoretically and empirically justify our main takeaway, which is that their orthogonality and polytopes results are trivially true in high-dimensional spaces, and can be observed even in settings where they should not occur.",
      "published": "April 28, 2025",
      "authors": [
        {
          "author": "Satvik Golechha",
          "authorURL": "https://www.7vik.io",
          "affiliations": [
            {
              "name": "MATS Program, MSR",
              "url": "https://www.matsprogram.org"
            }
          ]
        },
        {
          "author": "Lucius Bushnaq",
          "authorURL": "https://www.lesswrong.com/users/lblack",
          "affiliations": [
            {
              "name": "Apollo Research",
              "url": "https://www.apolloresearch.ai"
            }
          ]
        },
        {
          "author": "Euan Ong",
          "authorURL": "https://ong.ac/",
          "affiliations": [
            {
              "name": "Anthropic",
              "url": "https://www.anthropic.com"
            }
          ]
        },
        {
          "author": "Neeraj Kayal",
          "authorURL": "https://www.microsoft.com/en-us/research/people/neeraka/",
          "affiliations": [
            {
              "name": "Microsoft Research",
              "url": "https://www.microsoft.com/en-us/research"
            }
          ]
        },
        {
          "author": "Nandi Schoots",
          "authorURL": "https://scholar.google.com/citations?hl=en&user=wO7fg6wAAAAJ",
          "affiliations": [
            {
              "name": "University of Oxford",
              "url": "https://www.ox.ac.uk"
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> </head> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/2025/">ICLR Blogposts 2025</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/2025/about/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/call/">call for blogposts</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/submitting/">submitting</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/reviewing/">reviewing</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">past iterations</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2025/" rel="external nofollow noopener noopener noreferrer" target="_blank"><strong>2025</strong></a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2024/" rel="external nofollow noopener noopener noreferrer" target="_blank">2024</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2023/" rel="external nofollow noopener noopener noreferrer" target="_blank">2023</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blog-track.github.io/home/" rel="external nofollow noopener noopener noreferrer" target="_blank">2022</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Intricacies of Feature Geometry in Large Language Models</h1> <p>Studying the geometry of a language model's embedding space is an important and challenging task because of the various ways concepts can be represented, extracted, and used. Specifically, we want a framework that unifies both measurement (of how well a latent explains a feature/concept) and causal intervention (how well it can be used to control/steer the model). We discuss several challenges with using some recent approaches to study the geometry of categorical and hierarchical concepts in large language models (LLMs) and both theoretically and empirically justify our main takeaway, which is that their orthogonality and polytopes results are trivially true in high-dimensional spaces, and can be observed even in settings where they should not occur.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#an-overview-of-the-feature-geometry-papers">An Overview of the Feature Geometry Papers</a></div> <div><a href="#ablations">Ablations</a></div> <ul> <li><a href="#semantically-correlated-concepts">Semantically Correlated Concepts</a></li> <li><a href="#random-nonsensical-concepts">Random Nonsensical Concepts</a></li> </ul> <div><a href="#hierarchical-features-are-orthogonal-but-so-are-semantic-opposites">Hierarchical features are orthogonal - but so are semantic opposites!?</a></div> <div><a href="#categorical-features-form-simplices-but-so-do-totally-random-ones">Categorical features form simplices - but so do totally random ones!?</a></div> <div><a href="#random-unembeddings-exhibiting-the-same-geometry">Random Unembeddings Exhibiting the same Geometry</a></div> <div><a href="#orthogonality-and-polytopes-proofs-in-high-dimensions">Orthogonality and Polytopes Proofs in High Dimensions</a></div> <ul> <li><a href="#orthogonality-and-the-whitening-transformation">Orthogonality and the Whitening Transformation</a></li> <li><a href="#case-n-k">Case n≥k</a></li> <li><a href="#case-n-k">Case n<k></k></a></li> <li><a href="#high-dimensional-convex-hulls-are-easy-to-escape">High-Dimensional Convex Hulls are easy to Escape!</a></li> </ul> <div><a href="#discussion">Discussion</a></div> <ul> <li><a href="#conclusion">Conclusion</a></li> <li><a href="#wider-context-related-works">Wider Context / Related Works</a></li> <li><a href="#future-work">Future Work</a></li> </ul> <div><a href="#reproducibility">Reproducibility</a></div> </nav> </d-contents> <h2 id="an-overview-of-the-feature-geometry-papers">An Overview of the Feature Geometry Papers</h2> <p>We present several ablation results and theoretical arguments highlighting challenges with the theses of two recent works, the <a href="https://icml2024mi.pages.dev/" rel="external nofollow noopener noopener noreferrer" target="_blank"><strong>ICML 2024 Mechanistic Interpretability Workshop</strong></a> <strong>1st prize</strong> winning paper - <a href="https://arxiv.org/abs/2406.01506v1" rel="external nofollow noopener noopener noreferrer" target="_blank">The Geometry of Categorical and Hierarchical Concepts in LLMs</a> <d-cite key="park2024geometrycategoricalhierarchicalconcepts"></d-cite>, and the <strong>ICML 2024</strong> paper - <a href="https://arxiv.org/abs/2311.03658" rel="external nofollow noopener noopener noreferrer" target="_blank">The Linear Representation Hypothesis and the Geometry of LLMs</a> <d-cite key="park2024linearrepresentationhypothesisgeometry"></d-cite>.</p> <p>The methodology described in the two papers we study is as follows – they split the computation of a large language model (LLM) into everything before the unembedding and the unembedding itself:</p> \[P(y \mid x) = \frac{\exp(\lambda(x)^\top \gamma(y))}{\sum_{y' \in \text{Vocab}} \exp(\lambda(x)^\top \gamma(y'))}\] <p>where:</p> <ul> <li>$\lambda(x)$ is the context embedding for input $x$ (last token’s residual after the last layer)</li> <li>$\gamma(y)$ is the unembedding vector for output $y$ (using the unembedding matrix $W_U$)</li> </ul> <p>They formalize a notion of a <em>binary concept</em> as a latent variable $W$ that is caused by the context $X$ and causes output $Y(W=w)$ depending only on the value of $w \in W$.</p> <blockquote> <p>Comment: Crucially, this restricts their methodology to only work with concepts that can be differentiated by single-token counterfactual pairs of outputs. For instance, it is not clear how to define several important concepts such as “sycophancy” and “truthfulness” using their formalism.</p> </blockquote> <p>They then define linear representations of a concept in both the embedding and unembedding spaces:</p> <p>In the unembedding space, $\barγ_W$ is considered a representation of a concept W if \(\gamma (Y (1)) − \gamma (Y (0)) = \alpha\bar \gamma_W\) almost surely, where $\alpha &gt; 0$.</p> <blockquote> <p>Comment: This definition has the hidden assumption that each pair $(Y(0), Y(1))$ sampled from the vocabulary would only correspond to a unique concept. For instance, (“king”, “queen”) can correspond to a variety of concepts such as “male ⇒ female”, “k-words ⇒ q-words”, and “n’th card ⇒ (n-1)’th card” in a deck of playing cards.</p> </blockquote> <p>In the embedding space, they say that $\bar{\lambda}_W$ is a representation of a concept $W$ if we have $\lambda_1 - \lambda_0 \in \text{Cone}(\bar{\lambda}_W)$ for any context embeddings $\lambda_0, \lambda_1 \in \Lambda$ that satisfy \(\frac{\mathbb{P}(W = 1 \mid \lambda_1)}{\mathbb{P}(W = 1 \mid \lambda_0)} &gt; 1 \quad \text{and} \quad \frac{\mathbb{P}(W, Z \mid \lambda_1)}{\mathbb{P}(W, Z \mid \lambda_0)} = \frac{\mathbb{P}(W \mid \lambda_1)}{\mathbb{P}(W \mid \lambda_0)},\) for each concept $Z$ that is causally separable with $W$. The first condition means that the probability of a concept $W$ being true given a context embedding $\lambda_1$ is greater than under context embedding $\lambda_0$.</p> <p>Now, in order to work with concept representations (i.e. look at similarities, projections, etc.), we need to define an inner product. They provide the following definition <d-cite key="park2024linearrepresentationhypothesisgeometry"></d-cite>:</p> <p>$\textbf{Definition 3.1 (Causal Inner Product).}$ A $\textit{causal inner product}$ $\langle \cdot, \cdot \rangle_\mathcal{C}$ on $\overline{\Gamma} \simeq \mathbb{R}^d$ is an inner product such that \(\langle \overline{\gamma}_W, \overline{\gamma}_Z \rangle_\mathcal{C} = 0,\) for any pair of causally separable concepts $W$ and $Z$.</p> <blockquote> <p>Comment: Note that this definition allows the inner product $&lt;a,b&gt;=0 \forall (a,b) : a\ne b$ to be a causal inner product. As we show, the whitening transformation they apply as an explicit example of a causal inner product does indeed make almost everything almost orthogonal.</p> </blockquote> <p>This choice turns out to have the key property that it unifies the unembedding and embedding representations <d-cite key="park2024linearrepresentationhypothesisgeometry"></d-cite>. Intuitively, this means that how concepts are represented in the model’s output space matches how they’re represented in its internal computation:</p> <p>$\text{Theorem 3.2 (Unification of Representations).}$ Suppose that, for any concept $W$, there exist concepts \(\{ Z_i \} _{i=1}^{d-1}\) such that each \(Z_i\) is causally separable with \(W\) and \(\{ \overline{\gamma}_W \} \cup \{ \overline{\gamma}_{Z_i} \}_{i=1}^{d-1}\) is a basis of \(\mathbb{R}^d\). If \(\langle \cdot, \cdot \rangle_\mathcal{C}\) is a causal inner product, then the Riesz isomorphism \(\overline{\gamma} \mapsto \langle \overline{\gamma}, \cdot \rangle_\mathcal{C}\), for \(\overline{\gamma} \in \overline{\Gamma}\), maps the unembedding representation \(\overline{\gamma}_W\) of each concept \(W\) to its embedding representation \(\overline{\lambda}_W\):</p> \[\langle \overline{\gamma}_W, \cdot \rangle_\mathcal{C} = \overline{\lambda}_W^\top.\] <hr> <p>For an explicit example of a causal inner product, they consider the <em>whitening transformation</em> using the covariance matrix of the unembedding vectors as follows <d-cite key="park2024linearrepresentationhypothesisgeometry"></d-cite>:</p> \[g(y) = \text{Cov}(\gamma)^{-1/2} (\gamma(y) - \mathbb{E}[\gamma])\] <p>where $\gamma$ is the unembedding vector, $\mathbb{E}[\gamma]$ is the expected unembedding vector, and $\text{Cov}$ is the covariance matrix of $\gamma$. They show that under this transformation, the embedding and unembedding representations are the same.</p> <p>Now, for any concept $W$, its vector representation $\ell_W$ is defined to be:</p> \[\bar{\ell}_w = (\tilde{g}_w^\top\mathbb{E}(g_w)) \tilde{g}_w, \text{where} \,\,\,\, \tilde{g}_w = \frac{\text{Cov}(g_w)^\dagger\mathbb{E}(g_w)}{\|\text{Cov}(g_w)^\dagger\mathbb{E}(g_w)\|_2}\] <p>These are their main orthogonality results <d-cite key="park2024geometrycategoricalhierarchicalconcepts"></d-cite>:</p> <p>$\textbf{Theorem 8 (Hierarchical Orthogonality).}$ Suppose there exist such vector representations $l_w$ for binary concepts (where $\ell_{w_1} - \ell_{w_0}$ is the linear representation of $w_0 \Rightarrow w_1$), the following orthogonality relations hold:</p> \[\ell_w \perp (\ell_z - \ell_w) \quad \text{for } z \prec w\] <blockquote> <p>Comment: This illustrates that for hierarchical concepts mammal $\prec$ animal, we have $\ell_{animal} \perp (\ell_{mammal} - \ell_{animal})$. They prove this holds true and empirically validate it by plotting various animal representation points in the 2D span of the vectors for <em>animal</em> and <em>mammal</em>.</p> </blockquote> \[\ell_w \perp (\ell_{z_1} - \ell_{z_0}) \quad \text{for } \{z_0, z_1\} \prec w\] <blockquote> <p>Similarly, this means $\ell_{animal} \perp (\ell_{mammal} - \ell_{reptile})$.</p> </blockquote> \[(\ell_{w_1} - \ell_{w_0}) \perp (\ell_{z_1} - \ell_{z_0}) \quad \text{for } \{z_0, z_1\} \prec \{w_0, w_1\}\] \[(\ell_{w_1} - \ell_{w_0}) \perp (\ell_{w_2} - \ell_{w_1}) \quad \text{for } w_2 \prec w_1 \prec w_0\] <p>Lastly, they show that in their transformed space, categorical features form polytopes in $n$-dimensions. They empirically show these results to hold in the <a href="https://ai.google.dev/gemma" rel="external nofollow noopener noopener noreferrer" target="_blank">Gemma-2B</a> model and use the WordNet hierarchy to validate them at scale.</p> <h2 id="ablations">Ablations</h2> <p>While we find the dataset they study (animal categories and hierarchies) to indeed exhibit the geometry they predict, to study concepts that do not form such semantic categories and hierarchies, we add the following two datasets:</p> <h3 id="semantically-correlated-concepts">Semantically Correlated Concepts</h3> <p>First, an “emotions” dictionary for various kinds of emotions split in various top-level emotions. Note that these categories are not expected to be orthogonal (for instance, joy and sadness should be anti-correlated). We create this via a simple call to <a href="https://chatgpt.com/" rel="external nofollow noopener noopener noreferrer" target="_blank">ChatGPT</a>:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td> <td class="code"><pre><span class="n">emotions</span> <span class="o">=</span> <span class="p">{</span>
   <span class="sh">'</span><span class="s">joy</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">mirth</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">thrill</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">bliss</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">relief</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">admiration</span><span class="sh">'</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">'</span><span class="s">sadness</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">dejection</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">anguish</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">nostalgia</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">melancholy</span><span class="sh">'</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">'</span><span class="s">anger</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">displeasure</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">spite</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">irritation</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">disdain</span><span class="sh">'</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">'</span><span class="s">fear</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">nervousness</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">paranoia</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">discomfort</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">helplessness</span><span class="sh">'</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">'</span><span class="s">surprise</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">enthrallment</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">unexpectedness</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">revitalization</span><span class="sh">'</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">'</span><span class="s">disgust</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">detestation</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">displeasure</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">prudishness</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">disdain</span><span class="sh">'</span><span class="p">,</span> <span class="p">...]</span>
<span class="p">}</span>
</pre></td> </tr></tbody></table></code></pre></figure> <h3 id="random-nonsensical-concepts">Random Nonsensical Concepts</h3> <p>Next, we add a “nonsense” dataset that has five completely random categories where each category is defined by several (order of 100) completely random objects completely unrelated to the top-level categories:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td> <td class="code"><pre><span class="n">nonsense</span> <span class="o">=</span> <span class="p">{</span>
   <span class="sh">"</span><span class="s">random 1</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">toaster</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">penguin</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">jelly</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">cactus</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">submarine</span><span class="sh">"</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">"</span><span class="s">random 2</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">sandwich</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">yo-yo</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">plank</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">rainbow</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">monocle</span><span class="sh">"</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">"</span><span class="s">random 3</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">kiwi</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">tornado</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">chopstick</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">helicopter</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">sunflower</span><span class="sh">"</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">"</span><span class="s">random 4</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">ocean</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">microscope</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">tiger</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">pasta</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">umbrella</span><span class="sh">"</span><span class="p">,</span> <span class="p">...],</span>
   <span class="sh">"</span><span class="s">random 5</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">banjo</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">skyscraper</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">avocado</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">sphinx</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">teacup</span><span class="sh">"</span><span class="p">,</span> <span class="p">...]</span>
<span class="p">}</span>
</pre></td> </tr></tbody></table></code></pre></figure> <p>Please see the reproducibility statement in the end for the exact details of our setup and the full dictionaries.</p> <h2 id="hierarchical-features-are-orthogonal---but-so-are-semantic-opposites">Hierarchical features are orthogonal - but so are semantic opposites!?</h2> <p>Now, let’s look at their main experimental results for animal hierarchies (see Fig. 2 in their <a href="https://arxiv.org/pdf/2406.01506v1" rel="external nofollow noopener noopener noreferrer" target="_blank">original paper</a>):</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/1-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/1.png" class="img-fluid" width="50%" height="300px" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> $\ell_{animal} \perp (\ell_{mammal} - \ell_{animal})$, as shown by the original paper. The gray dots represent random tokens from the vocabulary. </div> <p>And this is the first ablation we run – all emotion words in the 2D span of sadness and emotions:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/2-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/2-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/2-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/2.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Emotion vectors (see the section on "Ablations") plotted in the span of sadness and emotions. As with animals, most emotions seem to follow orthogonality. </div> <p>Specifically, this is what we get for joy vectors in the span of sadness. Note that the orthogonality observed is very similar to that in the case of animal hierarchies.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/3-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/3-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/3-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/3.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Joy and sadness (semantically anti-correlated concepts) also exhibit the same kind of orthogonality under their transformation. </div> <p>Should we really have joy so un-correlated with sadness? Sadness and joy are semantic opposites, so one should expect the vectors to be anti-correlated rather than orthogonal.</p> <p>Also, here’s the same plot but for completely random, non-sensical concepts:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/4-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/4-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/4-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/4.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> The same geometry exhibit by random, non-sense concept vectors. </div> <p>It seems like their orthogonality results, while true for hierarchical concepts, are also true for semantically opposite concepts and totally random concepts. In the next section, we will show theoretically that in high-dimensions, random vectors, and in particular those obtained after the whitening transformation, are expected to be trivially orthogonal with a very high probability.</p> <h2 id="categorical-features-form-simplices---but-so-do-totally-random-ones">Categorical features form simplices - but so do totally random ones!?</h2> <p>Here is the simplex they find animal categories to form (see Fig. 3 in their <a href="https://arxiv.org/pdf/2406.01506v1" rel="external nofollow noopener noopener noreferrer" target="_blank">original paper</a>):</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/5-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/5-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/5-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/5.jpg" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Reproducing their polytopes/simplices result from the original paper. </div> <p>And this is what we get for completely random concepts:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/6-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/6-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/6-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/6.jpg" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> The same kind of polytopes forming for random, non-sensical concepts. Note that the variance of the points is also very similar and not higher than that of semantically meaningful categories. </div> <p>Thus, while categorical concepts form simplices, so do completely random, non-sensical concepts. Again, as we will show theoretically, randomly made categories are likely to form simplices and polytopes as well, because it is very easy to escape finite convex hulls in high-dimensional spaces.</p> <h2 id="random-unembeddings-exhibit-similar-geometry">Random Unembeddings Exhibit Similar Geometry</h2> <p>Here, we show that under the <a href="https://en.wikipedia.org/wiki/Whitening_transformation" rel="external nofollow noopener noopener noreferrer" target="_blank"><em>whitening transformation</em></a>, even random (completely untrained) unembeddings exhibit similar geometry as the trained ones. This gives more empirical evidence that the orthogonality and polytope findings are trivially true and do not “emerge” during the training of a language model.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/7-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/7-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/7-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/7.jpg" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Hierarchical concepts are orthogonal (although with higher variance) even in random (untrained) unembedding spaces. </div> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/8-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/8-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-feature-geometry/8-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-feature-geometry/8.jpg" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Categorical concepts form polytopes even in random (untrained) unembedding spaces. </div> <p>In the next section, we will theoretically show why these orthogonality and polytope results are trivially true in high-dimensions. Since the dimension of the residual stream of the Gemma model they used is $2048$, we claim many of their empirical findings are expected by default and do not show anything specific about the geometry of feature embeddings in trained language models.</p> <h2 id="orthogonality-and-polytopes-proofs-in-high-dimensions">Orthogonality and Polytopes Proofs in High Dimensions</h2> <h3 id="orthogonality-and-the-whitening-transformation">Orthogonality and the Whitening Transformation</h3> <p>Many of the paper’s claims and empirical findings are about the orthogonality of various linear probes for concepts in unembedding space. Importantly though, “orthogonal” here is defined using an inner product after a whitening transformation. Under this definition, most concept probes are going to end up being almost orthogonal by default.</p> <p>To explain why this happens, we will first discuss a simplified case where we assume that we are studying the representations in a language model with <em>residual stream</em> width $n$ equal to or greater than the number of <em>tokens in its dictionary</em> $k$. In this case, all the orthogonality results shown in <code class="language-plaintext highlighter-rouge">Theorem 8</code> of the paper would exactly hold for any arbitrary concept hierachies we make up. So observing that the relationships in <code class="language-plaintext highlighter-rouge">Theorem 8</code> hold for a set of linear concept probes would not tell us anything about whether the model uses these concepts or not.</p> <p>Then, we will discuss real models like <code class="language-plaintext highlighter-rouge">Gemma-2B</code> that have a residual stream width smaller than the number of tokens in their dictionary. For such models, the results in <code class="language-plaintext highlighter-rouge">Theorem 8</code> would not automatically hold for any set of concepts we make up. But in high dimensions, the theorem would still be expected to hold approximately, with most concept vectors ending up almost orthogonal. Most of the emprirical results for orthogonality the paper shows (see our section on empirical results) are consistent with this amount of almost-orthogonality that would be expected by default.</p> <h3 id="case-ngeq-k">Case $n\geq k:$</h3> <p>The whitening transformation will essentially attempt to make all the vocabulary vectors as orthogonal to each other as possible. When the dimensionality $n$ is greater than the number of vectors $k$ (i.e., $n &gt; k$), the whitening transformation can make the vectors exactly orthogonal.</p> <p>Let \(\{ \mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_k \} \in \mathbb{R}^n\) be zero-mean random vectors with covariance matrix $\Sigma$, where $n &gt; k$. Then there exists a whitening transformation $W = \Sigma^{-1/2}$ such that the transformed vectors \(\{ \mathbf{y}_i = W\mathbf{x}_i \}_{i=1}^k\) satisfy:</p> \[\mathbb{E}[\mathbf{y}_i^\top\mathbf{y}_j] = \delta_{ij}\] <p>where $\delta_{ij}$ is the <a href="https://en.wikipedia.org/wiki/Kronecker_delta#:~:text=In%20mathematics%2C%20the%20Kronecker%20delta,example%2C%20because%20%2C%20whereas%20because%20." rel="external nofollow noopener noopener noreferrer" target="_blank">Kronecker delta</a>.</p> <p><strong>Proof:</strong></p> <p>$1.$ Consider the eigendecomposition $\Sigma = U\Lambda U^\top$, where \(\Lambda = \text{diag}(\lambda_1, \dots, \lambda_k)\) .</p> <p>$2.$ Define $W = \Lambda^{-1/2}U^\top$. Then for any $i, j$:</p> \[\begin{aligned} \mathbb{E}[\mathbf{y}_i^\top\mathbf{y}_j] &amp;= \mathbb{E}[(W\mathbf{x}_i)^\top(W\mathbf{x}_j)] \\ &amp;= W\mathbb{E}[\mathbf{x}_i\mathbf{x}_j^\top]W^\top \\ &amp;= W\Sigma W^\top = I_k \end{aligned}\] <p>$3.$ If $n &gt; k$, we can extend $W$ to an $n \times n$ orthogonal matrix that preserves the orthogonality property.</p> <p>This matters, because if the dictionary embeddings are orthogonal, the relationships for concept vectors the paper derives will hold for completely made-up concept hierachies. They don’t have to be related to the structure of the language or the geometry of the original, untransformed unembedding matrix of the model at all.</p> <p>As an example, consider a dictionary with $k=6$ tokens and a residual stream of width $n=6$. The tokens could, for instance, just be the first six letters of the alphabet, namely $\text{{a, b, c, d, e, f}}$. Following the convention of the paper, we will call the unembedding vectors of the tokens \(\ell_a, \ell_b,\dots, \ell_f\) .</p> <p>Due the the whitening transformation, these vectors will be orthogonal under the causal inner product:</p> <p>$\ell_a \cdot \ell_b=0$</p> <p>$\cdots$</p> <p>$\ell_e \cdot \ell_f=0$</p> <p>The relationships described in <code class="language-plaintext highlighter-rouge">Theorem 8</code> of the paper will then hold for any hierarchical categorization schemes of concepts defined over these tokens. The concepts do not need to be meaningful in any way, and they do not need to have anything to do with the statistical relationship between the six tokens in the training data.</p> <p>For example, let us declare the binary concept \(\text{\{blegg, rube\}}\). Tokens $\text$ are “bleggs”, and tokens $\text$ are “rubes”. We further categorize each “blegg” as being one of $\text$, making a categorical concept. Token “a” is a “lant”, “b” is a “nant” and “c” is a “blip”.</p> <p>We can create a linear probe $l_{\text{blegg}}$ that checks whether the current token vector is a ‘blegg’. It returns a nonzero value b_blegg/b_rube if the token is a ‘blegg’, and a value of 0 if it is a ‘rube’ (see <code class="language-plaintext highlighter-rouge">Theorem 4</code> in the paper).</p> <p>We could train the probe with LDA like the paper does, but in this case, the setup is simple enough that the answer can be found immediately. In the whitened coordinate system, we write:</p> <p>$\ell_{\text{blegg}}=\ell_a+\ell_b+\ell_c$</p> <p>$\ell_{\text{rube}}=\ell_d+\ell_e+\ell_f$</p> <p>Constructing linear probes for ‘lant’ ‘nant’ and ‘blip’ is also straigthforward:</p> <p>$\ell_{\text{lant}}=\ell_a$</p> <p>$\ell_{\text{nant}}=\ell_b$</p> <p>$\ell_{\text{blip}}=\ell_c$</p> <p>Following the paper’s definitions, {‘lant’,’nant’, ‘blip’} is subordinate to {‘blegg’,’rube’}. We see that <code class="language-plaintext highlighter-rouge">Theorems 8 (a,b,c)</code> in the paper that illustrated in their <code class="language-plaintext highlighter-rouge">Figure 2</code> will hold for these vectors.</p> <p>8 (a) $\ell_{\text{blegg}}\cdot(\ell_{\text{lant}}-\ell_{\text{blegg}})=0$</p> <p>8 (b) $\ell_{\text{blegg}}\cdot(\ell_{\text{lant}}-\ell_{\text{nant}})=0$</p> <p>8 (c) $(\ell_{\text{blegg}}-\ell_{\text{rube}})\cdot(\ell_{\text{lant}}-\ell_{\text{nant}})=0$</p> <p>So, in a $n$-dimensional space containing unembedding vectors for $n=k$ dictionary elements, Theorem 8 will hold for any self consistent categorisation scheme. Theorem 8 will also keep holding if we replace the unembedding matrix $W_{\text{unembed}}\in \mathbb{R}^{k\times n}$ with a randomly chosen full rank matrix. Due to the whitening applied by the ‘causal inner product’, the concepts we make up do not need to have any relationship to the geometry of the unembedding vectors in the model.</p> <h3 id="case-nk">Case $n&lt;k:$</h3> <p>If the model’s residual stream is smaller than the number of tokens in its dictionary, as is the case in Gemma-2B and most other models, the whitening transformation cannot make all $k$ unembedding vectors $x_1,\dots,x_k$ exactly orthogonal. So Theorem 8 will no longer be satisfied by default for all concept hierarchies and all unembedding matrices we make up.</p> <p>However, if $n,k$ are large, the whitening transformation might often still be able to make most unembedding vectors almost orthogonal, because random vectors in high dimensional spaces tend to be almost orthogonal by default.</p> <p>To see why this is the case, consider $k$ random vectors $\mathbf{x}_i \in \mathbb{R}^n$ for $i = 1, 2, \dots, k$ drawn from the unit sphere. We will show that as the dimensionality $n$ increases, these vectors become approximately orthogonal.</p> <p>The expected value of the inner product $\langle \mathbf{x}_i, \mathbf{x}_j \rangle$ is:</p> \[\mathbb{E}[\langle \mathbf{x}_i, \mathbf{x}_j \rangle] = \mathbb{E}\left[\sum_{l=1}^n x_{il} x_{jl}\right] = \sum_{l=1}^n \mathbb{E}[x_{il} x_{jl}]\] <p>The elements of the vectors have zero mean, so we have $\mathbb{E}[x_{il} x_{jl}] = 0$ for $i \neq j$. Therefore, the expectation value of the inner product is $\mathbb{E}[\langle \mathbf{x}_i, \mathbf{x}_j \rangle]$ is $0$.</p> <p>The variance of the inner product is:</p> \[\text{Var}[\langle \mathbf{x}_i, \mathbf{x}_j \rangle] = \text{Var}\left[\sum_{l=1}^n x_{il} x_{jl}\right] = \sum_{l=1}^n \text{Var}[x_{il} x_{jl}] = \frac{1}{n}\] <p>Thus, in high dimensions, the cosine of the angle $\theta$ between two random vectors has mean $0$ and deviation $\frac{1}{\sqrt(n)} \to 0$, meaning vectors will be nearly orthogonal with high probability.</p> <p>In fact, the <a href="https://en.wikipedia.org/wiki/Johnson%E2%80%93Lindenstrauss_lemma" rel="external nofollow noopener noopener noreferrer" target="_blank">Johnson–Lindenstrauss lemma</a> states that the number of <em>almost orthogonal</em> vectors that can be fit in $n$ dimensions is exponential in $n$.</p> <p>So, going back to our example in the previous section, if the vectors $\ell_{a}, \dots,\ell_{f}$ are approximately orthogonal instead of orthogonal, then, the linear probes for the concepts {‘blegg’,’rube’}, {‘lant’,’nant’, ‘blip’} we made up would still mostly satisfy Theorem 8, up to terms $\mathcal{O}(\frac{1}{\sqrt{n}})$:</p> <p>8 (a) $\ell_{\text{blegg}}\cdot(\ell_{\text{lant}}-\ell_{\text{blegg}})=\mathcal{O}(\frac{1}{\sqrt{n}})$</p> <p>8 (b) $\ell_{\text{blegg}}\cdot(\ell_{\text{lant}}-\ell_{\text{nant}})=\mathcal{O}(\frac{1}{\sqrt{n}})$</p> <p>8 (c) $(\ell_{\text{blegg}}-\ell_{\text{rube}})\cdot(\ell_{\text{lant}}-\ell_{\text{nant}})=\mathcal{O}(\frac{1}{\sqrt{n}})$</p> <p>So, orthogonality between linear probes for concepts might be expected by default, up to terms $\mathcal{O}(\frac{1}{\sqrt{n}})$ that will become very small for big models with large residual stream widths $n$. To exceed this baseline, the causal inner product between vector representations would need to be clearly smaller than $\mathcal{O}(\frac{1}{\sqrt{n}})$.</p> <h3 id="high-dimensional-convex-hulls-are-easy-to-escape">High-Dimensional Convex Hulls are easy to Escape!</h3> <p>As for the polytope results in their paper (Definition 7, Figure 3 ), a random vector is highly likely to be outside the convex hull of $k$ vectors in high dimensions, so we should expect concepts to “form a polytope” by default.</p> <p>Let \(\{ \mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_k \} \in \mathbb{R}^n\) be $k&lt;n$ independent random vectors drawn from the unit sphere. The convex hull of \(\{ \mathbf{x}_1, \mathbf{x}_2, \dots, \mathbf{x}_k \}\) is the set of points \(\sum_{i=1}^k \alpha_i \mathbf{x}_i\), where \(\alpha_i \geq 0\) and $\sum_{i=1}^k \alpha_i = 1$.</p> <p>Since this polytope is contained in a $k$-dimensional subspace inside the larger $n$-dimensional space, its volume is $k&lt;n$ dimensional rather than $n$ dimensional. So it has a n-dimensional <a href="https://en.wikipedia.org/wiki/Lebesgue_measure" rel="external nofollow noopener noopener noreferrer" target="_blank">Lebesgue measure</a> of zero. So the probability that another random vector $\mathbf{z}$ lies inside this polytope will be zero. In the real world, our vector coordinates are floating point numbers of finite precision rather than real numbers, so the probability of $\mathbf{z}$ lying inside the polytope will not be exactly zero, but it will still be very small. Thus, it is not surprising that the polytopes spanned by linear probes for $k$ concepts do not intersect with linear probes for other concepts.</p> <p>Even if we were to look at $k&gt;n$ categorical concepts, <a href="https://www.cambridge.org/core/journals/canadian-mathematical-bulletin/article/empty-simplices-in-euclidean-space/1F81907C277EE2F91525C44C9DB54316" rel="external nofollow noopener noopener noreferrer" target="_blank">Theorem 1 (Bárány and Füredi (1998))</a> shows, as described in <d-cite key="lecunextra"></d-cite> that one would need a very, very high number of categories (of the order of $\frac{2^{1024}}{2048}$) to have a vector that’s inside the convex hull.</p> <h2 id="discussion">Discussion</h2> <h3 id="conclusion">Conclusion</h3> <p>We provide theoretical and empirical justification that the orthogonality and polytope results observed by recent works are a trivial consequence of the whitening transformation and the high dimensionality of the representation spaces.</p> <p>A transformation where opposite concepts seem orthogonal doesn’t seem good for studying models. It breaks our semantic model of associating directions with concepts and makes steering both ways impossible. Thus, more work needs to be done in order to study concept representations in language models.</p> <h3 id="related-works">Related Works</h3> <p>Recent research has found multiple ways to extract latents representing concepts/features in a model’s activation space. We highlight some of them:</p> <h4 id="linear-contraststeering-vectors">Linear Contrast/Steering Vectors</h4> <p>If we have a contrast dataset $(x^+, x^-)$ for a feature or behavior, we can use the contrast activations to get a $direction$ in a given layer’s activation space that represents the concept. This can also be used to steer models toward or away from it, as is shown in Representation Engineering <d-cite key="zou2023representationengineeringtopdownapproach"></d-cite>.</p> <p>One can also extract linear <em>function vectors</em> in the activation space by eliciting in-context learning <d-cite key="todd2024functionvectorslargelanguage"></d-cite>.</p> <h4 id="sparse-autoencoders-saes-and-variants">Sparse Autoencoders (SAEs) and Variants</h4> <p>SAEs have been found to be a very scalable method to extract linear representations for a lot of features by learning a sparse reconstruction of a model’s activations <d-cite key="cunningham2023sparseautoencodershighlyinterpretable"></d-cite>. There have been several recent advancements on SAEs in terms of both methodology and scaling.</p> <h4 id="unsupervised-steering-vectors">Unsupervised Steering Vectors</h4> <p>This work <d-cite key="mack2024melbo"></d-cite> uses an unsupervised method to elicit latent behavior from a language model by finding directions in a layer’s activations that cause a maximum change in the activations of a future layer.</p> <h4 id="non-linear-features">Non-linear Features</h4> <p>While several important concepts are found to have linear representation latents (possibly due to the highly linear structure of the model’s architecture), not all features in a language model are represented linearly, as shown here <d-cite key="engels2024languagemodelfeatureslinear"></d-cite>.</p> <h3 id="future-work">Future Work</h3> <p>We hope that our work points out various challenges toward a unified framework to study model representations and promotes further interest in the community to work on the same. Some important future directions this leaves us with are:</p> <ul> <li>A framework on how to think about representations that unifies how they’re obtained (contrastive activations, PCA, SAE, etc.), how they’re used (by the model), and how they can be used to control (eg. via steering vectors).</li> <li>How to figure out how well a given object (a direction, a vector, or even a black-box function over model parameters) represents a given human-interpretable concept or feature.</li> <li>If orthogonality and simplices are too universal and not specific enough to study the geometry of categorical and hierarchical concepts, then what is a good lens or theory to do so?</li> </ul> <p>Lastly, instead of the whitening transformation (which leads to identity covariance), one can attempt to use an inverse, i.e., a coloring transformation using a covariance matrix that is learned directly from the data.</p> <h2 id="reproducibility">Reproducibility</h2> <p>All our results are completely reproducible and do not change with random seeds. The complete dictionaries for the two ablations we run (emotions and nonsense) are available <a href="https://github.com/7vik/intricacies-feature-geometry" rel="external nofollow noopener noopener noreferrer" target="_blank">here</a>, and the code and hyperparameters we use are exactly the same as those used by the original authors, all of which is available on their <a href="https://github.com/KihoPark/LLM_Categorical_Hierarchical_Representations" rel="external nofollow noopener noopener noreferrer" target="_blank">public repository</a>.</p> <p>To reproduce our results, replace the original dictionary in the paper (for animals) with one of the others. For the random unembedding experiment, replace the unembedding matrix $W_U$ with <code class="language-plaintext highlighter-rouge">torch.randn_like(W_U)</code> and follow the rest of their methodology.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/2025/assets/bibliography/2025-04-28-feature-geometry.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, please cite this work as <pre id="bibtex-academic-attribution">
        PLACEHOLDER FOR ACADEMIC ATTRIBUTION
  </pre> BibTeX citation <pre id="bibtex-box">
        PLACEHOLDER FOR BIBTEX
  </pre> </d-article> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2025" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>