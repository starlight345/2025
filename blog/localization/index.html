<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script>let thunk=()=>{let e=e=>e.trim(),t=e=>e.innerText,i=e=>{let t=e.split(" "),i=t.slice(0,-1).join(" ");return[t.at(-1),i]},a=Array.from(document.getElementsByClassName("author")).map(t).map(e).map(i),n=a[0][0],o=(Array.from(document.getElementsByClassName("affiliation")).filter(e=>"P"===e.nodeName).map(t).map(e),"April 28, 2025"),l="Does Editing Provide Evidence for Localization?",s="A basic aspiration for interpretability research in large language models is to localize semantically meaningful behaviors to particular components within the LLM. There are various heuristics for finding candidate locations within the LLM. Once a candidate localization is found, it can be assessed by editing the internal representations at the corresponding localization and checking whether this induces model behavior that is consistent with the semantic interpretion of the localization. The question we address here is, how strong is the evidence provided by such edits? To assess localization, we want to assess the effect of the optimal intervention at a particular location. The key new technical tool is a way of adapting LLM alignment techniques to find such optimal localized edits. With this tool in hand, we give an example where the edit-based evidence for localization appears strong, but where localization clearly fails. Indeed, we find that optimal edits at random localizations can be as effective as aligning the full model. In aggregate, our results suggest that merely observing that localized edits induce targeted changes in behavior provides little to no evidence that these locations actually encode the target behavior.";{let e=a.map(e=>`${e[0]}, ${e[1]}`).join(" and "),t=`\n@inproceedings{${(n+"2025"+l.split(" ").slice(0,3).join("")).replace(" ","").replace(/[\p{P}$+<=>^`|~]/gu,"").toLowerCase().trim()},\n  author = {${e}},\n  title = {${l}},\n  abstract = {${s}},\n  booktitle = {ICLR Blogposts 2025},\n  year = {2025},\n  date = {${o}},\n  note = {${window.location.href}},\n  url  = {${window.location.href}}\n}\n  `.trim();document.getElementById("bibtex-box").innerText=t}{let e=a.map(e=>e[0]),t=`\n${e=e.length>2?e[0]+", et al.":2==e.length?e[0]+" & "+e[1]:e[0]}, "${l}", ICLR Blogposts, 2025.\n`.trim();document.getElementById("bibtex-academic-attribution").innerText=t}};document.addEventListener("readystatechange",function(){"complete"===document.readyState&&thunk()});</script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Does Editing Provide Evidence for Localization? | ICLR Blogposts 2025</title> <meta name="author" content="ICLR Blog"> <meta name="description" content="A basic aspiration for interpretability research in large language models is to localize semantically meaningful behaviors to particular components within the LLM. There are various heuristics for finding candidate locations within the LLM. Once a candidate localization is found, it can be assessed by editing the internal representations at the corresponding localization and checking whether this induces model behavior that is consistent with the semantic interpretion of the localization. The question we address here is, how strong is the evidence provided by such edits? To assess localization, we want to assess the effect of the optimal intervention at a particular location. The key new technical tool is a way of adapting LLM alignment techniques to find such optimal localized edits. With this tool in hand, we give an example where the edit-based evidence for localization appears strong, but where localization clearly fails. Indeed, we find that optimal edits at random localizations can be as effective as aligning the full model. In aggregate, our results suggest that merely observing that localized edits induce targeted changes in behavior provides little to no evidence that these locations actually encode the target behavior."> <meta name="keywords" content="machine-learning, ml, deep-learning, reinforcement-learning, iclr"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/2025/assets/img/iclr_favicon.ico"> <link rel="stylesheet" href="/2025/assets/css/main.css"> <link rel="canonical" href="https://starlight345.github.io/2025/blog/localization/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/2025/assets/js/theme.js"></script> <script src="/2025/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/2025/assets/js/distillpub/template.v2.js"></script> <script src="/2025/assets/js/distillpub/transforms.v2.js"></script> <script src="/2025/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> <d-front-matter> <script async type="text/json">{
      "title": "Does Editing Provide Evidence for Localization?",
      "description": "A basic aspiration for interpretability research in large language models is to localize semantically meaningful behaviors to particular components within the LLM. There are various heuristics for finding candidate locations within the LLM. Once a candidate localization is found, it can be assessed by editing the internal representations at the corresponding localization and checking whether this induces model behavior that is consistent with the semantic interpretion of the localization. The question we address here is, how strong is the evidence provided by such edits? To assess localization, we want to assess the effect of the optimal intervention at a particular location. The key new technical tool is a way of adapting LLM alignment techniques to find such optimal localized edits. With this tool in hand, we give an example where the edit-based evidence for localization appears strong, but where localization clearly fails. Indeed, we find that optimal edits at random localizations can be as effective as aligning the full model. In aggregate, our results suggest that merely observing that localized edits induce targeted changes in behavior provides little to no evidence that these locations actually encode the target behavior.",
      "published": "April 28, 2025",
      "authors": [
        {
          "author": "Zihao Wang",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Department of Statistics, University of Chicago",
              "url": "https://zihao12.github.io"
            }
          ]
        },
        {
          "author": "Victor Veitch",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Department of Statistics, University of Chicago",
              "url": "https://www.victorveitch.com"
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> </head> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/2025/">ICLR Blogposts 2025</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/2025/about/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/call/">call for blogposts</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/submitting/">submitting</a> </li> <li class="nav-item "> <a class="nav-link" href="/2025/reviewing/">reviewing</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">past iterations</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2025/" rel="external nofollow noopener noopener noreferrer" target="_blank"><strong>2025</strong></a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2024/" rel="external nofollow noopener noopener noreferrer" target="_blank">2024</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blogposts.github.io/2023/" rel="external nofollow noopener noopener noreferrer" target="_blank">2023</a> <div class="dropdown-divider"></div> <a class="dropdown-item" href="https://iclr-blog-track.github.io/home/" rel="external nofollow noopener noopener noreferrer" target="_blank">2022</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>Does Editing Provide Evidence for Localization?</h1> <p>A basic aspiration for interpretability research in large language models is to localize semantically meaningful behaviors to particular components within the LLM. There are various heuristics for finding candidate locations within the LLM. Once a candidate localization is found, it can be assessed by editing the internal representations at the corresponding localization and checking whether this induces model behavior that is consistent with the semantic interpretion of the localization. The question we address here is, how strong is the evidence provided by such edits? To assess localization, we want to assess the effect of the optimal intervention at a particular location. The key new technical tool is a way of adapting LLM alignment techniques to find such optimal localized edits. With this tool in hand, we give an example where the edit-based evidence for localization appears strong, but where localization clearly fails. Indeed, we find that optimal edits at random localizations can be as effective as aligning the full model. In aggregate, our results suggest that merely observing that localized edits induce targeted changes in behavior provides little to no evidence that these locations actually encode the target behavior.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#introduction">Introduction</a></div> <div><a href="#backgrounds-and-results-from-iti">Backgrounds and results from ITI</a></div> <div><a href="#editing-localized-heads-modifies-the-output-as-expected">Editing Localized Heads Modifies the Output as Expected</a></div> <div><a href="#finding-optimal-interventions">Finding "optimal" interventions</a></div> <div><a href="#optimal-interventions-at-localized-heads-are-nearly-optimal-but-so-are-random-heads">Optimal interventions at localized heads are nearly optimal, but so are random heads</a></div> <div><a href="#intervening-a-single-head-is-just-as-effective">Intervening a single head is just as effective</a></div> <div><a href="#are-the-probing-localized-heads-anything-special">Are the Probing-Localized Heads Anything Special?</a></div> <div><a href="#discussion">Discussion</a></div> <div><a href="#experiment-details">Experiment Details</a></div> </nav> </d-contents> <h2 id="introduction">Introduction</h2> <p> A basic goal of interpretability research for large language models is to map semantically meaningful behavior to particular subcomponents of the model. Semantically meaningful encompasses a wide range of things, e.g., "when asked for directions to the Eiffel tower, the model gives directions to Paris", "the model responds truthfully", or "the model will refuse to response". The aim is to find, e.g., neurons, circuits, or regions of representation space that control these behaviors. If we could find such localizations, we could use them as building blocks to understand complex model behaviors. Many interpretability approaches can be understood in terms of the following idealized template <d-cite key="zou2023representation,arditi2024refusal,wang2023backdoor,chen2024truth,wei2024assessing,li2024inference,meng2022locating,vig2020causal,geiger2021causal,soulos2019discovering,finlayson2021causal,wang2022interpretability,chan2022causal,hanna2024does,conmy2023towards,todd2023function,hendel2023context"></d-cite>: </p> <p> 1. We use some heuristic to find a candidate location in the model that is conjectured to be responsible for a particular behavior. </p> <p> 2. We then run the model with some set of inputs, and collect the model's internal representations for each input. </p> <p> 3. Then, we edit each of these representations at the candidate location, and generate new outputs according to the edited representations. </p> <p> 4. If the edit changes the model's behavior in the manner that would be expected from changing the target behavior, we take this as evidence in support of localization. </p> <p> For example, if editing a particular location in the network shifts the model to give truthful answers, we may take this as evidence that the location meaningfully encodes truthfulness in some sense. Or, if editing a location causes the model to act as though the Eiffel tower is in Rome, we may take this as evidence that the location encodes the concept of the Eiffel tower. The basic question in this paper is: how strong is this evidence? That is, to what extent can we conclude that a particular location in the model is responsible for a particular behavior based on the success of editing at that location? </p> <p> Our core contribution is an example where editing-based evidence appears very strong, but where localization clearly fails. The example replicates the setup of Inference-Time-Interference (ITI) <d-cite key="li2024inference"></d-cite>, where the target concept is truthfulness, and the localization is in a small subset of 16 attention heads. Following ITI, we use logit-linear probing to identify candidate heads. We then search for the optimal localized edit to apply at these heads. Remarkably, we find that the optimal edit induces truthfulness behavior that is essentially as good as finetuning the entire model to be truthful. That is, the localized edit is as effective as can possibly be expected. Intuitively, this appears to be strong evidence that the locations found by the heuristic (probing) are indeed closely linked to the target concept (truthfulness). However, we then show that this evidence is misleading. We find that applying optimal edits to <em>random heads</em> are just as effective as when applied to the localized heads. Accordingly, the edit-based evidence provides no support for the localization hypothesis. </p> <p> A possible out here is that 16 attention heads is too many, leaving us with significant leeway to induce any behavior we want with editing. We further strengthen the example by showing that it is possible to find a <em>single</em> head in the model where editing at that head is as effective as finetuning the entire model. This appears to be the strongest edit-based evidence for localization possible. However, we show that there are in fact multiple such heads. That is, there is simply no single privileged location that can be identified as responsible for the target behavior. </p> <p> Our results suggest that the evidence provided by editing is weak, and that the success of editing at a particular location is not a reliable indicator of the location's importance for the target behavior. This seems to significantly constrain what can be learned from interpretability methods. It also points to the need for a more rigorous development of such techniques, including both precise statements of what the goals are, and well-grounded standards for evidence that these goals have been met. </p> <p> The technical development in this paper relies on finding the optimal intervention at a specified location. To that end, we develop a method for localizing LoRA type finetuning to specific locations. This then allows us to frame the search for optimal edits as a finetuning-type optimization problem. This method may also be of independent interest. </p> <h2 id="backgrounds-and-results-from-iti">Backgrounds and Results from ITI</h2> <p> We replicate the setup of ITI <d-cite key="li2024inference"></d-cite>. </p> <h3>Dataset and Model Architecture</h3> <p> We use TruthfulQA <d-cite key="lin2021truthfulqa"></d-cite> as our dataset. It contains 817 questions that humans might answer incorrectly due to misconceptions. Each question contains an average of 3.2 truthful answers and 4.1 false answers. We use 60% of the questions for training, and the rest for validation and testing. </p> <p> We use an Alpaca-7B <d-cite key="taori2023alpaca"></d-cite> model that is finetuned from the Llama-7B base model. The model consists of $L = 32$ layers, each consisting of a Multi-head Attention (MHA) layer, and a Multilayer Perceptron (MLP) layer. We focus on the MHA layer, which has $H = 32$ attention heads, with each head having dimension $H = 128$ (the hidden dimension is $DH = 4096$). </p> <p> Ignoring MLP and layer normalization, the computation at layer $l$ can be written as: </p> <p><a id="eq1"></a> \(\mathbf{o}_h^l := \text{Attn}_h^l(\mathbf{r}^l) \in \mathbb{R}^D\)</p> <p><a id="eq2"></a> \(\mathbf{o}^l := [(\mathbf{o}_1^l)^T, \ldots, (\mathbf{o}_H^l)^T]^T \in \mathbb{R}^{DH}\)</p> <p><a id="eq3"></a> \(W^l := [W_1^l, \ldots, W_H^l] \in \mathbb{R}^{DH \times DH}\)</p> <p><a id="eq4"></a> \(\mathbf{r}^{l+1} := \mathbf{r}^l + W^l \mathbf{o} = \mathbf{r}^l + \sum_{h=1}^H W_h \mathbf{o}_h \in \mathbb{R}^{DH}\)</p> <p> where $\mathbf{r}^l \in \mathbb{R}^{DH}$ is the residual stream before layer $l$, $\text{Attn}_h^l$ is the $h$-th attention module at layer $l$, with $\mathbf{o}_h^$ being its output. $\mathbf{o}^l$ is the concatenated head outputs. $W^l$ is the project-out matrix, that applies $H$ independent linear transformations to the corresponding head outputs. Finally $\mathbf{r}^{l+1}$ is residual stream output after layer $l$. </p> <h3>Localization and Intervention Using Activation Statistics</h3> <p> To localize, we collect representations for positive and negative examples, and use probing to find where the truthfulness concept is represented. To intervene, we find the direction best separating activations for positive and negative examples, and apply this direction to the representation. </p> <p> Each example is of the form, $(x, y, x_{\text{random}})$, concatenating a question $x$, a corresponding answer $y$, and another random question $x_{\text{random}}$. For positive examples, we use a truthful response $y = y_{+}$, and for negative examples, we use an untruthful response $y = y_{-}$. To collect the representations, we feed the positive and negative examples through the model, and collect the activations of the attention heads, $\{\mathbf{o}_h^l\}_{h \in [H], l \in [L]}$, at the last token. </p> <p> For each of the $L \times H$ head locations, we train a logistic regression probe on the $D$-dimensional activations to predict whether it's a positive or negative example. Then we pick the attention heads with the highest probing accuracies as the localized heads. </p> <p> For the selected head at $(l, h)$, we find the direction $\mathbf{u}_h^l$ that is "best" at separating the activations of positive and negative examples. There are several variants, but according to <d-cite key="li2024inference"></d-cite>, the best option is the mass mean shift, which is the difference between the average positive and negative activations. Then we estimate the standard deviation of activations along the direction to be $\sigma_h^l$, and use the weighted direction $\boldsymbol{\theta}_h^l := \sigma_h^l \mathbf{u}_h^l$ as the intervention vector, which we add to the corresponding head during inference autoregressively. </p> <p> More specifically, the applied intervention is: </p> <p><a id="eq5"></a> \(\mathbf{r}^{l+1}_{\text{ITI}} := \mathbf{r}^l + W^l ( \mathbf{o} + \alpha \boldsymbol{\theta}^l)\)</p> <p><a id="eq6"></a> \(= \mathbf{r}^{l+1}_{\text{orig}} + \alpha W^l \boldsymbol{\theta}^l = \mathbf{r}^{l+1}_{\text{orig}} + \alpha \sum_{h=1}^H W_h^l \boldsymbol{\theta}_h^l\)</p> <p> where $\mathbf{\theta}_l$ is the concatenated intervention vectors across all heads at layer $l$, and $\alpha$ is the intervention strength. This intervention is repeated for each next token prediction autoregressively until the whole answer is completed. </p> <h3>Evaluation Metrics</h3> <p> Since the goal is to assess model's generation quality, it's natural to use truthfulness score and informativeness score of generations as the evaluation metrics. They use GPT-judge models <d-cite key="lin2021truthfulqa"></d-cite> to evaluate the model's generations for truthfulness and informativeness, and use Info*Truth (the product of scalar truthful and informative scores) as the main metric. </p> <p> We also report other metrics as in the ITI paper: KL divergence of the model's next-token prediction distribution post- versus pre-intervention, and multiple-choice accuracy (MC) which is determined via comparing the conditional probabilities of candidate answers given the question. </p> <h2>Editing Localized Heads Modifies the Output as Expected</h2> <p> In ITI, the authors find that editing on 16 localized heads (out of a total of 1024 heads) successfully steers model generations to be more truthful while still being informative. They also find intervening on all attention heads doesn't make model generations more truthful than intervening just at the localized heads. This seems to suggest that the truthfulness concept is indeed encoded in the localized heads. </p> <p> We now strengthen this evidence further. Similar to <d-cite key="hase2024does"></d-cite>, we check if interventions at random heads can also make model generations more truthful. More specifically: </p> <p> 1. Randomly select 16 heads, and compute intervention vectors $\theta$'s accordingly. </p> <p> 2. Apply varying intervention strength α, collect model generations, and compute scores for truthfulness and informativeness using GPT-judge across all intervention strengths. </p> <p> 3. Repeat for 16 times. </p> <p> We find that interventions at the localized heads are more effective than interventions at random heads. In <a href="#fig-iti-hist">Figure below</a> we report the Info*Truth score (average truthfulness score times average informativeness score). We find that using localized heads have significantly higher Truth*Info scores than using random heads (p-value $1.6×10^{-8}$). In fact, using random heads often doesn't have noticeable effect on the truthfulness at all, as shown in the truth-info plot (<a href="#fig-truth-info">Figure</a>) and KL-MC trade-off plot (<a href="#fig-kl-mc">Figure</a>). </p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0" id="fig-iti-hist"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/hist_iti-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/hist_iti-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/hist_iti-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/hist_iti.png" class="img-fluid" width="auto" height="auto" title="Info*Truth Scores" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="subfig-caption" style="font-size: 0.5em; color: #ffffff; background-color: rgba(0, 0, 0, 0.7); padding: 1px; margin-top: 1px; text-align: center;"> Info*Truth Scores </div> </div> <div class="col-sm mt-3 mt-md-0" id="fig-truth-info"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/iti_truth_info-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/iti_truth_info-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/iti_truth_info-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/iti_truth_info.png" class="img-fluid" width="auto" height="auto" title="Truth vs Info Scores" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="subfig-caption" style="font-size: 0.5em; color: #ffffff; background-color: rgba(0, 0, 0, 0.7); padding: 1px; margin-top: 1px; text-align: center;"> Truth vs Info Scores </div> </div> <div class="col-sm mt-3 mt-md-0" id="fig-kl-mc"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/iti_kl_mc-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/iti_kl_mc-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/iti_kl_mc-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/iti_kl_mc.png" class="img-fluid" width="auto" height="auto" title="KL vs MC Scores" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="subfig-caption" style="font-size: 0.5em; color: #ffffff; background-color: rgba(0, 0, 0, 0.7); padding: 1px; margin-top: 1px; text-align: center;"> KL vs MC Scores </div> </div> </div> <div class="caption" id="fig-localization"> Localized heads perform much better than random when using ITI interventions. We observe better Truth*Info scores, better truth-info score tradeoff, as well as better MC-KL tradeoff. </div> <p> This appears to add further evidence that the localized heads are "special" for the truthfulness concept. However, this strong association could be because the intervention and localization are "correlated", since both use statistics of the same activations (determined by the design of the data, etc). E.g. for heads with very low probing accuracy, the estimated intervention vectors could be very noisy, and thus the interventions could be less effective. </p> <h2>Finding "Optimal" Interventions</h2> <p> To test whether a particular behavior is localized to specific location, we would like to assess the effect of the <em>optimal</em> intervention at that location. In the case of our running example, we want the localized edit to the representation space that does the best job of steering the model's generations to be more truthful while maintaining informativeness. Then, the questions are: what is the best we could hope to achieve? (I.e., what is "optimal"?) And, (how) can we find a localized edit that achieves it? </p> <h3>Fitting the Alignment Objective Gives Optimal Interventions</h3> <div id="fig-ipo"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/stronger_evidence_for_loc-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/stronger_evidence_for_loc-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/stronger_evidence_for_loc-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/stronger_evidence_for_loc.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> IPO interventions achieve much better performance than using ITI. Using IPO interventions at localized heads give nearly optimal info-truth tradeoff as well. </div> </div> <p> The key observation is that the dataset used to construct positive and negative examples can be restructured as paired "preference" data $\{(x_i, y_i^+, y_i^-)\}_i$, where $x_i$ is the question, $y_i^+$ is the truthful answer, and $y_i^-$ is the untruthful answer. Since the goal is to make model generations more truthful, we can directly adopt contrastive alignment methods for biasing the model towards the truthful answers. In this case, we use the IPO <d-cite key="azar2024general"></d-cite> learning objective, where the goal is to upweight probabilities for $y_i^+$ and downweight probabilities for $y_i^-$ (up to some threshold): </p> <p> $ \text{argmax}_{\phi} \sum_i \left[\log \left( \frac{\pi_{\phi}(y_i^{+} | x_i)}{\pi_0(y_i^{+} | x_i)} / \frac{\pi_{\phi}(y_i^{-} | x_i)}{\pi_0(y_i^{-} | x_i)} \right) - \frac{\tau^{-1}}{2}\right]^2 $ </p> <p> where $\pi_\phi(\cdot \vert x)$ is the model's generation probability, $\pi_0(\cdot \vert x)$ is the original model's generation probability, and $\tau$ decides the threshold. Ideally, the optimized $\pi_{\phi^*}(\cdot \vert x)$ should generate responses that are more truthful than the original model, while minimally affecting the off-target aspects of the generation (in this case, the informativeness of the responses). </p> <p> To test the effectiveness of IPO alignment, we finetune the weights for project-out matrices $W^l$'s defined in <a href="#eq3">Equation 3</a> using (rank 1) LoRA <d-cite key="hu2021lora"></d-cite>. The finetuned model gives nearly perfect trade-off between truthfulness and informativeness, that is far better than ITI interventions (see <a href="#fig-ipo">Figure</a>). This also suggests that ITI heuristics are very far from optimal and contrasts with ITI results that intervening on all heads doesn't make model generations more truthful. </p> <p> Now we treat this result as the overall best performance that we can achieve with interventions. We want to see if optimal interventions at localized heads can achieve the same performance, and if random heads can achieve the same performance. </p> <h3>Connect Weight Updates to Representation Editing</h3> <p> The connection to IPO lets us search for the best possible update to the model's <em>weights</em>. However, we are interested in localized edits to model <em>representations</em>. To continue, we need to connect the weight editing to representation editing. </p> <h4>Rank-1 LoRA</h4> <p> Directly applying rank-1 LoRA to W^l, we can view the effect of adding in the modified LoRA weight matrix as an edit to the representation as follows: </p> <p> $ \mathbf{r}_{\text{LoRA}}^{l+1} := \mathbf{r}^l + (W^l + \mathbf{b}^l (\mathbf{a}^l)^T)\mathbf{o}^l = \mathbf{r}_{\text{orig}}^{l+1} + \left&lt; \mathbf{a}^l, \mathbf{o}^l\right&gt; \mathbf{b}^l $ </p> <p> where $a^l, b^l$ are the LoRA weights to optimize. Comparing with <a href="#eq5">the ITI intervention</a> , we see that $b^l$ plays the role of the added $W^l \theta^l$, and $\langle a^l, o^l \rangle$ is the intervention strength but is adapted to the representation $\mathbf{o}$.<d-footnote>One could replace $\langle a^l, o^l \rangle$ with a constant intervention strength, but allowing the extra flexibility is closer to the ideal of best-possible-localized-intervention.</d-footnote> </p> <p> This formulation connects weight edits to representation edits. However, it doesn't yet allow us to localize edits to specific heads -- while $\theta^l$ can be read as concatenation of headwise intervention vectors, the projected $W^l \theta^l$ have no corresponding interpretations. Therefore, we can't restrict the edits to specific heads by imposing structure on $b^l$'s. </p> <h4>Rank-1 LoRA with Reparameterization</h4> <p> We can make more direct connections by reparameterizing $b^l$ with $W^l b^l$ (without changing expressiveness): </p> <p> $ \mathbf{r}_{\text{LoRA-reparam}}^{l+1} := \mathbf{r}_{\text{orig}}^{l+1} + \left&lt; \mathbf{a}^l, \mathbf{o}^l\right&gt; W^l \mathbf{b}^l = \mathbf{r}_{\text{orig}}^{l+1} + \left&lt; \mathbf{a}^l, \mathbf{o}^l\right&gt; \sum_{h=1}^H W_h^l \mathbf{b}_h^l $ </p> <p> Here $b_h^l$ plays the role of the intervention vector $\theta_h^l$, and $a^l$ decides the intervention strength adaptively. </p> <p> Now we have the algorithm to find the optimal interventions for the chosen set of heads: </p> <p> 1. Finetune the model weights using reparameterized LoRA with the IPO objective. </p> <p> 2. And, restrict $b^l$ to be nonzero only for the chosen set of heads. </p> <h2>Optimal Interventions at Localized Heads are Nearly Optimal, but so are Random Heads</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0" id="hist_ipo"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/hist_ipo.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" id="random_vs_top"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/random_vs_top.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Using IPO optimal localized interventions, randomly selected heads perform nearly optimally for steering model generations. In particular, random heads are as good as the conjectured localized heads. The random heads are the same as those in <a href="#fig-iti-hist">earlier truth-info plots</a>. </div> <h3>Optimal Edits at Conjectured Localization</h3> <p> We can now search for the best possible interventions at the localized heads. The earlier figure shows the result. We find that the optimal interventions strongly outperform the heuristic ITI interventions. Moreover, the localized interventions are about as effective as full IPO alignment! This appears to be the strongest edit-based evidence for localization that we could hope for. </p> <h3>Optimal Edits at Random Localization</h3> <p> Now, we apply the same optimal edit procedure to 16 <em>randomly selected</em> heads. The figure above shows the results. In short: the optimal interventions at random heads are often just as effective as the optimal interventions at the localized heads. Accordingly, the fact that editing at the localized heads was effective at steering generations provides no evidence that the truthfulness concept is localized to those heads. </p> <p> Further, the random heads we use here are the same random heads used earlier. Using the ITI heuristic intervention, the selected heads looked highly different from these random heads. But we now see that this appears to be an artifact of the suboptimal interventions and choice of metric, rather than a meaningful difference in how the heads relate to truthfulness. </p> <h2>Intervening a Single Head is Just as Effective</h2> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0" id="hist_ipo_1"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo_1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo_1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/hist_ipo_1-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/hist_ipo_1.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0" id="single_vs_top"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/single_vs_top-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/single_vs_top-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/single_vs_top-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/single_vs_top.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Using a single-head is as effective, and there are multiple of them! </div> <p> It is now clear that edit-based evidence does not provide strong evidence for localization in the 16 head setup. However, a possible way of saving localization would be to argue that 16 heads is too many, giving too much leeway to induce any behavior we want with editing. For example, if we edited half the heads of the model, it would not be surprising if we could make the model do anything we wanted. Accordingly, we might hope that there is still a valid syllogism of the form "the localized edit is extremely constrainted" and "edits at this location optimally control the target behavior" implies "the target behavior is localized to this location". </p> <p> To test this, we now focus on the single head case. The procedure is simple: we randomly sample 24 single heads, one at a time, and search for optimal interventions. The distribution of the best Truth*Info scores is shown in <a href="#hist_ipo_1">the figure above</a>. We find <a href="#single_vs_top">5 single-heads that are as effective</a>, and none of them has high probing accuracy. Notice that, still, none of these heads can be understood as localizing the truthfulness concept. The reason is that there are multiple distinct locations that work equally well! That is, even in the extreme case of a very localized edit that replicates the target behavior essentially optimally, we still cannot conclude that there is evidence supporting localization. </p> <h2>Are the Probing-Localized Heads Anything Special?</h2> <p> So far what we mean by localization, is that we can change model generation on target concept by an edits at this location. And our experiments show no evidence for this type of localization, and probing-localized heads play no special role. </p> <p> So, are the probing-localized heads anything special at all? </p> <h3>Probing-localized Heads Seems Special for MC Scores</h3> <p> We do observe that these heads achieve slightly better Multiple-Choice (MC) scores compared to randomly selected heads (see <a href="#random_vs_top_MC_KL"> figures below</a>), although this advantage is not as pronounced as with the ITI interventions (see <a href="#fig-kl-mc">earlier figures</a>). Thus, these heads may be special in terms of changing model probabilities on the given fixed dataset, which is what MC measures. </p> <h3>The Gap Between What the Model "Knows" and What it Generates</h3> <p> It's important to note that the model's probabilities for fixed responses, do not directly correspond to what the model actually generates. Even if the model assigns a higher probability to a truthful response than an untruthful one, it may still not generate the truthful response if the fixed dataset is off-policy (i.e. both probabilities are low). This highlights the well-known gap between what a model "knows" (which is the motivation behind probing) and what it ultimately generates <d-cite key="joshi2023personas,wang2020language,kadavath2022language,saunders2022self,burns2022discovering"></d-cite>. </p> <div id="random_vs_top_MC_KL"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top_MC_KL-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top_MC_KL-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/2025/assets/img/2025-04-28-localization/random_vs_top_MC_KL-1400.webp"></source> <img src="/2025/assets/img/2025-04-28-localization/random_vs_top_MC_KL.png" class="img-fluid" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <div class="caption"> Probing-localized heads seem somewhat special in MC scores. </div> </div> <h3>Implications</h3> <p> It's possible that while probing-localized heads are not special at all for controlling model generations, they are special in changing what the model "knows". Though we caution that the results here are not rigorous evidence for localization even in this sense. Even if there is a knowledge localization in some sense, it is clear that this does not inform steering, and does not give a way of monitoring model behavior (because changes in completely unrelated locations can change the behavior). This points to the need for making the goal of localization precise. </p> <h2>Discussion</h2> <p> The main idea in this paper is that to assess the localization of a behavior we should study the effect of the <em>optimal</em> intervention at the conjectured localization. The main obstacle is that, in general, it is not clear how to define or find the optimal intervention. To overcome this, we map the problem of finding the optimal intervention to the problem of finding the optimal weight update, which can be solved using existing LLM alignment methods. </p> <p> The main result is an example where, naively, the evidence for localization appears strong, but when we use optimal interventions, the evidence disappears. </p> <p> The particular example—truthfulness and ITI-based evidence—was selected simply because the data used to define the heuristic happens to also allow us to set up a contrastive alignment problem. The most limited read of the results here is that ITI interventions do not provide evidence for localization, and that truthfulness does not appear to be localizable. However, the broader point is that by giving an example where editing-based evidence doesn't support localization, we see that in general such edits—by themselves—cannot provide evidence for localization. This is true irrespective of the particular behavior or heuristic being evaluated. </p> <p> Thus far, we've been a bit vague about what localization means. Editing does tautological evidence for localization in the sense of "it's possible to modify model behavior on such-and-such a behavior by an edit at this location". On the opposite end, the strongest possible standard would be to show that the location is unique, or at least necessary. This is the standard that would be required if our aim was, e.g., to establish that LLM truthfulness can be monitored by examining a small set of heads. Potentially, there are interesting and useful notions of localization in between these two extremes. However, we can see no useful sense of localization that is consistent with the location being only as good as a <em>randomly selected</em> alternative. As we have seen, heuristic edit-based evaluation cannot even rule out this case. </p> <p> Our findings add to a growing body of work that assesses the validity of interpretability results. <d-cite key="niu2024does"></d-cite> argue that the Knowledge Neuron thesis, which suggests that facts are stored in MLP weights, is an oversimplification and does not adequately explain the process of factual expression in language models. <d-cite key="makelov2023subspace"></d-cite> demonstrate that subspace activation patching can lead to an illusory sense of interpretability, as the effects may be achieved through dormant parallel pathways rather than the hypothesized subspaces. Most relevant to our work, <d-cite key="hase2024does"></d-cite> find that localization conclusions from causal tracing do not provide insight into which model MLP layer would be best to edit to override an existing stored fact. </p> <p> Overall, the results here point to the need for precise statements of what the objectives are in interpretability. With clear objectives, it may be possible to develop theoretically grounded methods for evaluation. Precise, falsifiable, statements and clear standards of evidence would suffice to prevent the kind of failure we observe in this paper. </p> <h2>Experiment Details</h2> <h3>Dataset and Model Architecture</h3> <p> We use the TruthfulQA dataset <d-cite key="lin2021truthfulqa"></d-cite> and the Alpaca-7B model <d-cite key="taori2023alpaca"></d-cite> for our experiments. The dataset contains 817 questions with truthful and untruthful answers. We turn them into pairs, and use 60% for training (6560 paired data) and the rest for validation and testing. The model consists of 32 layers, each with 32 attention heads and a hidden dimension of 4096. </p> <h3>Training Details</h3> <p> We use IPO objective <d-cite key="azar2024general"></d-cite> and use hyperparameter $\tau = 0.1, 0.2, 0.3, 0.4, 0.5$. We train for two epochs with a cosine scheduler, with a batch size of 4. We use "paged_adamw_32bit" optimizer. For training with different numbers of heads, we find a smaller number of heads benefit from a higher learning rate. For all-heads, we use a learning rate of $1 \times 10^{-4}$, and for 16 heads, we use $5 \times 10^{-4}$. For single-head, we use $2 \times 10^{-3}$. </p> <h3>Evaluation Metrics</h3> <p> We reuse code from ITI <d-cite key="li2024inference"></d-cite> for evaluation when possible. For GPT-judge models, we follow <d-cite key="lin2021truthfulqa"></d-cite> and finetune on truthfulness and informativeness dataset using OpenAI API <d-cite key="openai2020api"></d-cite>. Our finetuned model achieves similar validation error as in <d-cite key="lin2021truthfulqa"></d-cite>. </p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <d-bibliography src="/2025/assets/bibliography/2025-04-28-localization.bib"></d-bibliography> <d-article id="bibtex-container" class="related highlight"> For attribution in academic contexts, please cite this work as <pre id="bibtex-academic-attribution">
        PLACEHOLDER FOR ACADEMIC ATTRIBUTION
  </pre> BibTeX citation <pre id="bibtex-box">
        PLACEHOLDER FOR BIBTEX
  </pre> </d-article> <script src="https://utteranc.es/client.js" repo="iclr-blogposts/2025" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>